(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[884],{9799:function(e,n,t){"use strict";var r=t(4942),o=t(5861),i=t(7757),u=t.n(i),c=t(9669),a=t.n(c),s=t(7294);function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.url,t=e.method,r=e.body,i=e.onSuccess,c=(0,s.useState)(null),l=c[0],p=c[1];return{doRequest:function(){var e=(0,o.Z)(u().mark((function e(){var o,c,s,l=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=l.length>0&&void 0!==l[0]?l[0]:{},e.prev=1,p(null),e.next=5,a()[t](n,d(d({},r),o));case 5:return c=e.sent,i&&i(c.data),e.abrupt("return",c.data);case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),s=e.t0.response.data.errors.map((function(e){return"".concat(e.message)})),p(s[0]);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),errors:l}}},9220:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return _}});var r=t(5861),o=t(7757),i=t.n(o),u=t(5538),c=(t(993),t(7294)),a=t(9799),s=t(6793),l=t(9669),d=function(e){var n=e.myWidgetFunction,t=e.style,r=e.buttonText;return c.createElement(c.Fragment,null,c.createElement("button",{id:"cloudinary_upload_button",style:t||{color:"white",border:"none",width:"120px",backgroundColor:"green",borderRadius:"4px",height:"25px"},onClick:function(){return n()}},r||"Upload files"))};function p(e,n,t,r,o,i,u){try{var c=e[i](u),a=c.value}catch(s){return void t(s)}c.done?n(a):Promise.resolve(a).then(r,o)}function f(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function v(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){f(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var g=t.n(l)().create();g.interceptors.response.use((function(e){return e.data}));var h=function(e,n,t,r){var o=t.generateSignatureUrl,i=t.accepts,u=t.contentType,c=t.withCredentials,a=t.customPublicId,s=t.eager,l=t.apiKey,d=t.resourceType;n=[].concat(n),r&&console.log(n,"Params"),Promise.all(n.map((function(e){var n=e;return r&&console.log(e),function(e){var n=e.url,t=e.data,r=e.accepts,o=e.contentType,i=e.withCredentials;g.defaults.headers.common.Accepts=r,g.defaults.headers.common["Content-Type"]=o,g.defaults.withCredentials=i;var u={url:n+"?nocache="+(new Date).getTime(),method:"get",params:t};return g(u)}({url:o,data:{params_to_sign:v(v(v(v(v(v(v({},e.filename_override&&{filename_override:e.filename_override}),e.headers&&{headers:e.headers}),s&&{eager:s}),a&&{public_id:a}),e.source&&{source:e.source}),{},{timestamp:e.timestamp,unique_filename:e.unique_filename},e.upload_preset&&{upload_preset:e.upload_preset}),e.use_filename&&{use_filename:e.use_filename})},accepts:i,contentType:u,withCredentials:c}).then((function(e){return r&&console.log(e,"Signature Response"),Object.assign({signature:e,api_key:l,resource_type:d},n)}))}))).then((function(n){r&&console.log(n,"Results"),e(1===n.length?n[0]:n)}))},b=function(e,n,t,r,o,i,u,c,a,s,l,d,f,m,g,b,y,w,j,O,x){(!!window.cloudinary&&window.cloudinary.createUploadWidget(v(v(v(v({multiple:x,singleUploadAutoClose:!0,showAdvancedOptions:!0,showPoweredBy:!1,googleDriveClientId:O,sources:e},n&&n),{},{cloudName:r,uploadPreset:o,folder:i,cropping:u,resourceType:t},c&&{use_filename:w}),c&&{unique_filename:j}),c&&{prepareUploadParams:function(){var e,n=(e=regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(n,r,{generateSignatureUrl:c,accepts:g,contentType:b,withCredentials:y,customPublicId:d,eager:f,apiKey:m,resourceType:t},l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function u(e){p(i,r,o,u,c,"next",e)}function c(e){p(i,r,o,u,c,"throw",e)}u(void 0)}))});return function(e,t){return n.apply(this,arguments)}}()}),(function(e,n){!e&&n&&"success"===n.event?(l&&console.log("Done! Here is the image info: ",n.info),l&&console.log(n),a&&a(n)):e?s?s({error:e,result:n}):l&&console.log({error:e,result:n}):t&&"shown"===n.info?console.log("setting resourceType"):l&&console.log(n)}))).open()},y=function(e){var n=e.sources,t=void 0===n?[]:n,r=e.sourceKeys,o=void 0===r?null:r,i=e.resourceType,u=void 0===i?"auto":i,a=e.cloudName,s=void 0===a?null:a,l=e.uploadPreset,p=void 0===l?null:l,f=e.buttonText,m=void 0===f?null:f,v=e.style,g=void 0===v?null:v,h=e.folder,y=void 0===h?null:h,w=e.cropping,j=void 0===w||w,O=e.generateSignatureUrl,x=e.onSuccess,_=void 0===x?null:x,P=e.onFailure,N=void 0===P?null:P,C=e.logging,E=void 0===C||C,T=e.customPublicId,S=void 0===T?null:T,D=e.eager,k=void 0===D?null:D,I=e.apiKey,U=void 0===I?null:I,R=e.accepts,A=void 0===R?"application/json":R,q=e.contentType,F=void 0===q?"application/json":q,Z=e.withCredentials,L=void 0===Z||Z,K=e.use_filename,X=void 0===K||K,B=e.unique_filename,W=void 0!==B&&B,Y=e.googleDriveClientId,H=void 0===Y?null:Y,$=e.multiple,z=void 0!==$&&$;return c.createElement(d,{myWidgetFunction:function(){return b(t,o,u,s,p,y,j,O,_,N,E,S,k,U,A,F,L,X,W,H,z)},buttonText:m,style:g})},w=function(){return c.createElement(c.Fragment,null,(e="https://widget.cloudinary.com/v2.0/global/all.js",void(0,c.useEffect)((function(){var n=document.createElement("script");return n.type="text/javascript",n.src=e,n.async=!0,document.body.appendChild(n),function(){document.body.removeChild(n)}}),[e])));var e},j=function(e){return c.createElement(y,e)},O=t(5893),x=t(4155);function _(e){var n=e.cloudName,t=e.preset,o=(0,c.useState)(""),l=o[0],d=o[1],p=(0,c.useState)(""),f=p[0],m=p[1],v=(0,c.useState)("-"),g=v[0],h=v[1],b=(0,s.$)(),y=b.t,x=(b.i18n,(0,a.Z)({url:"/api/devices",method:"put",body:{deviceId:l,purchaseProofUrl:f},onSuccess:function(e){e&&e.id&&u.Am.info("Device sucessfully registered"),d("")}})),_=x.doRequest,P=x.errors,N=function(){var e=(0,r.Z)(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),_();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){P&&u.Am.error(P)}),[P]),(0,O.jsxs)("div",{className:"py-16",children:[(0,O.jsx)("div",{className:"w-full md:w-96 md:max-w-full mx-auto",children:(0,O.jsx)("h1",{className:"mt-10 mb-10 px-4 font-bold text-3xl",children:y("regdevice")})}),(0,O.jsx)(u.Ix,{}),(0,O.jsx)("div",{className:"w-full md:w-96 md:max-w-full mx-auto p-4 bg-indigo-100",children:(0,O.jsxs)("div",{className:"p-6 border border-gray-300 sm:rounded-md",children:[(0,O.jsx)(w,{}),(0,O.jsx)(j,{sources:["local"],cloudName:n,uploadPreset:t,folder:"ohbiohealth",logging:!1,onSuccess:function(e){var n=e.info.url;"pdf"===e.info.format&&(n=n.slice(0,n.length-3)+"jpg"),h(e.info.original_filename),m(n)},onFailure:function(e){return console.log(e)}}),(0,O.jsx)("p",{className:"mt-6 mb-6",children:g}),(0,O.jsx)("form",{onSubmit:N,children:(0,O.jsxs)("div",{children:[(0,O.jsxs)("label",{className:"block mb-6",children:[(0,O.jsx)("span",{className:"text-gray-700",children:y("deviceid")}),(0,O.jsx)("input",{id:"deviceId",name:"deviceId",className:" block w-full mt-1 border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 ",value:l,type:"text",onChange:function(e){return d(e.target.value)}})]}),(0,O.jsx)("input",{type:"submit",value:y("submit"),className:" h-10 px-5 text-indigo-100 bg-indigo-700 rounded-lg transition-colors duration-150 focus:shadow-outline hover:bg-indigo-800 "})]})})]})})]})}_.getInitialProps=function(){var e=(0,r.Z)(i().mark((function e(n){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x.env.NEXT_PUBLIC_CLOUDINARY_CLOUD,r=x.env.NEXT_PUBLIC_CLOUDINARY_PRESET,e.abrupt("return",{cloudName:t,preset:r});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},2068:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/regdevice",function(){return t(9220)}])}},function(e){e.O(0,[37,774,888,179],(function(){return n=2068,e(e.s=n);var n}));var n=e.O();_N_E=n}]);